# Шаблонные строки

Шаблонные строки (Template Literals) в JavaScript, введенные в ES6 (ECMAScript 2015), — это мощный способ работы со
строками, который упрощает их формирование, интерполяцию выражений и создание многострочных текстов.
Они обозначаются обратными кавычками (`) и поддерживает вставку переменных, выражений и многострочный текст без сложных
конкатенаций.

## Основы шаблонных строк

* **Синтаксис:** Шаблонные строки заключаются в обратные кавычки (\`...\`), а не в одинарные (') или двойные (")
  кавычки.
* **Интерполяция:** Внутри шаблонных строк можно вставлять выражения с помощью `${выражение}`
* **Многопоточность:** Поддерживают переносы строк без специальных символов (\n).

## Примеры использования

### 1. Базовая интерполяция

### 2. Вычисления внутри интерполяции

### 3. Многострочные строки

### 4. Вложенные шаблонные строки

### 5. Работа с объектами и массивами

## Тегированные шаблонные строки

Шаблонные строки поддерживают теги - функции, которые обрабатывают шаблон перед его возвратом.
Тег — это функция, вызываемая перед строкой, которая получает массив строк и значения интерполяции.

### Пример тегированной строки

```js
function myTag(strings, ...values) {
    console.log(strings); // Массив строк между интерполяциями
    console.log(values); // Массив значений интерполяции
    rreturn
    values.map((val, i) => `${strings[i]}${val.toUpperCase()}`).join("") + strings[strings.length - 1];
}

const name = "Alice";
const role = "admin";
const result = myTag`Пользователь ${name} имеет роль ${role}.`;
console.log(result); // Пользователь ALICE имеет роль ADMIN.
```

* **strings:** Массив частей строки, разделенных интерполяциями (например, ["Пользователь ", " имеет роль ", "."]).
* **values:** Значения интерполяции (например, ["Alice", "admin"]).
* **Применение:** Теги полезны для формирования, локализации, фильтрации HTML и т.д.

## Особенности шаблонных строк

* **Читаемость:** Упрощают создание сложных строк по сравнению с конкатенацией.
* **Многострочность:** Удобный для HTML-шаблонов, SQL-запросов или длинных текстов.
* **Гибкость:** Поддерживают любые выражения в `${}`
* **Производительность:** Для простых случаев производительность сопоставима с конкатенацией, но теги могут быть
  ресурсоемкий при сложной обработке.

## Ловушки и рекомендации

### 1. Не злоупотребляйте сложными выражениями

Сложные вычисления в `${}` могут ухудшить читаемость.

```js
// Плохо
const str = `Результат: ${a * b + c / d - Math.sqrt(e)}`;
// Лучше
const calc = a * b + c / d - Math.sqrt(e);
const str = `Результат: ${calc}`;
```

### 2. Экранирование обратных кавычек

Чтобы использовать обратные кавычки внутри шаблонной строки, экранируйте их с помощью `\`:

```js
const code = `Код: \`const x = 5; \``;
console.log(code); // Код: `const x = 5`;
```

### 3. Безопасность с пользовательским вводом

Никогда не вставляйте непроверенные данные напрямую, особенно в HTML:

```js
const malicious = "<script>alert('hack')</script>";
const html = `<div>${malicious}</div>`; // Опасно!
// Решение использовать тегированные строки для экранирования
```

### 4. Рекомендации

* Используйте шаблонные строки вместо конкатенации для большей читаемости.
* Для многострочных текстов (например, HTML-шаблонов) шаблонные строки идеальны.
* При работе с пользовательским вводом применяйте тегированные строки для безопасности.
* Разбивайте сложные выражения на промежуточные переменные для ясности.

## Практические примеры

### 1. HTML-шаблон

```js
const user = {name: "Alice", role: "Admin"};
const html = `
<div class="user">
    <h1>${user.name}</h1>
    <p>Роль: ${user.role}</p>
</div>
`;

console.log(html);
```

### 2. Локализация с тегом

```js
function localize(strings, ...values) {
    const translations = {hello: "Привет", world: "Мир"};

    return strings.reduce((result, str, index) => {
        const value = values[i] ? translations[values[i] || values[i]] : "";
        return result + str + value;
    }, "");
}

const greeting = localize`Say ${"hello"} to the ${"world"}!`;
console.log(greeting); // Say Привет to the Мир!
```

## Когда использовать

* **Шаблонные строки:** Для форматирования строк, интерполяции переменных, создания многострочных текстов (например,
  HTML, SQL).
* **Тегированные строки:** Для обработки строк перед выводом (форматирование, локализация, экранирование).
* **Обычные строки:** Если требуется простая строка без интерполяции или многострочности.
